<!DOCTYPE html>
<html>
<head>
    <title>Recherche de Films</title>
</head>
<body>
    <div>
        <input type="text" id="searchInput" placeholder="Nom du film">
        <button onclick="searchMovie()">Rechercher</button>
    </div>

    <div id="movieDetails">
        <p>Nom du film: <span id="filmName"></span></p>
        <p>Autre nom: <span id="filmName2"></span></p>
        <p>Acteurs: <span id="actors"></span></p>
        <p>Réalisateur: <span id="director"></span></p>
        <p>Résumé: <span id="summary"></span></p>
        <p>Lien du poster: <span id="posterLink"></span></p>
        <p>Lien du film: <span id="filmLink"></span></p>
        <img id="posterImage" src="" alt="Poster du film" style="display: none;">
    </div>

    <script>
        async function searchMovie() {
            // Récupérer la valeur de recherche
            const movieName = document.getElementById('searchInput').value;
            
            try {
                // Faire la requête au serveur
                const response = await fetch(`http://localhost:3000/film/${movieName}`);
                
                if (!response.ok) {
                    throw new Error('Film non trouvé');
                }

                const movieData = await response.json();

                // Mettre à jour tous les éléments du DOM
                document.getElementById('filmName').textContent = movieData.filmName;
                document.getElementById('filmName2').textContent = movieData.filmName2;
                document.getElementById('actors').textContent = movieData.actors.join(', ');
                document.getElementById('director').textContent = movieData.director;
                document.getElementById('summary').textContent = movieData.summary;
                document.getElementById('posterLink').textContent = movieData.posterLink;
                document.getElementById('filmLink').textContent = movieData.filmLink;

                // Afficher l'image du poster si disponible
                const posterImage = document.getElementById('posterImage');
                if (movieData.posterLink) {
                    posterImage.src = movieData.posterLink;
                    posterImage.style.display = 'block';
                } else {
                    posterImage.style.display = 'none';
                }

            } catch (error) {
                // Gérer les erreurs
                alert('Erreur lors de la recherche du film: ' + error.message);
                
                // Réinitialiser tous les champs en cas d'erreur
                const elements = ['filmName', 'filmName2', 'actors', 'director', 'summary', 'posterLink', 'filmLink'];
                elements.forEach(element => {
                    document.getElementById(element).textContent = '';
                });
                document.getElementById('posterImage').style.display = 'none';
            }
        }

        // Ajouter la possibilité de rechercher en appuyant sur Entrée
        document.getElementById('searchInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                searchMovie();
            }
        });
    </script>
</body>
</html>