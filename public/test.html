<!DOCTYPE html>
<html lang="fr">
  <head>
    <style>
      body {
        background-color: rgb(0, 0, 0);
      }
    </style>
    <meta charset="UTF-8" />
    <title>Vérification d'Accès</title>
    <script>
      // Fonction pour récupérer un cookie par son nom
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(";").shift();
        return null;
      }

      // Fonction pour vérifier l'accès
      function checkAccess() {
        // Récupérer le uniqueId depuis les cookies
        const uniqueId = getCookie("uniqueId");

        if (!uniqueId) {
          document.getElementById("message").textContent =
            "Aucun identifiant trouvé. Veuillez vous connecter.";
          const redirectURL = `/login.html`;
          window.location.href = redirectURL;
          return;
        }

        // Envoyer une requête au serveur pour vérifier l'accès
        fetch(`/check-access?uniqueId=${uniqueId}`)
          .then((response) => {
            if (response.ok) {
              return response.text();
            } else {
              throw new Error("Accès refusé");
            }
          })
          .then((html) => {
            // Mettre à jour le contenu de la page
            document.body.innerHTML = html;
          })
          .catch((error) => {
            document.getElementById("message").textContent =
              "Accès non autorisé : " + error.message;
            const redirectURL = `/403.html`;
            window.location.href = redirectURL;
          });
      }

      // Lancer la vérification au chargement de la page
      window.onload = checkAccess;
    </script>
  </head>
  <body>
    <div id="message">Vérification de l'accès en cours...</div>
  </body>
    <script src="/film.js"></script>
</html>
